<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/favicon-16x16-next.png"><link rel="mask-icon" href="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"imajinyun.xyz",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"flat"},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"MY71JUZ8GH",apiKey:"06f460e5776acfe140c52e3ba3537780",indexName:"ProdNotes",hits:{per_page:10},labels:{input_placeholder:"ğŸ¶ Search for Posts",hits_empty:"ğŸ™ æœªå‘ç°ä¸<b>ã€${query}ã€</b>ç›¸å…³çš„å†…å®¹",hits_stats:'ğŸš€ <b style="color: red">${hits}</b> æ¡ç›¸å…³æ¡ç›®ï¼Œä½¿ç”¨äº† <b style="color: red">${time}</b> ms'}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"><meta property="og:type" content="website"><meta property="og:title" content="Jinyun&#39;s Notes ğŸš€"><meta property="og:url" content="https://imajinyun.xyz/page/12/index.html"><meta property="og:site_name" content="Jinyun&#39;s Notes ğŸš€"><meta property="og:description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="Jinyun"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://imajinyun.xyz/page/12/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!0,isPost:!1,lang:"zh-CN"}</script><title>Jinyun's Notes ğŸš€</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?80ab72b54c102cbfec5064e3feaea6c8";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ "><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Jinyun's Notes ğŸš€</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">æ²¡ä»€ä¹ˆå¤©èµ‹ï¼Œçˆ±å¥½ä¹Ÿä¸å¤šï¼Œä½†æ„¿åšæŒåšäº›å–œæ¬¢çš„äº‹æƒ…</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-paper-plane"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th-list"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive"></i>å½’æ¡£</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link"></i>å‹é“¾</a></li><li class="menu-item menu-item-speech"><a href="/speech/" rel="section"><i class="fa fa-microphone"></i>&nbsp;æ¼”è¯´</a></li><li class="menu-item menu-item-tools"><a href="/tools/" rel="section"><i class="fa fa-tools"></i>å¯¼èˆª</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div class="algolia-results"><div id="algolia-stats"></div><div id="algolia-hits"></div><div id="algolia-pagination" class="algolia-pagination"></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><a href="https://github.com/imajinyun" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content index posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://imajinyun.xyz/2018/04/13/php-date-calculation/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><meta itemprop="name" content="ç¬”è€…å¶åƒ"><meta itemprop="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jinyun's Notes ğŸš€"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2018/04/13/php-date-calculation/" class="post-title-link" itemprop="url">PHP - æ—¥æœŸç›¸å…³è®¡ç®—</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-04-13 22:34:21" itemprop="dateCreated datePublished" datetime="2018-04-13T22:34:21+08:00">2018-04-13</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-01 10:37:02" itemprop="dateModified" datetime="2021-07-01T10:37:02+08:00">2021-07-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>æ—¥æœŸå‡½æ•°åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ç”¨çš„æ¯”è¾ƒå¹¿æ³›ï¼Œå°¤å…¶æ˜¯ <code>date()</code> å‡½æ•°ï¼Œå¼ºå¤§åˆ°è®©äººçª’æ¯ï¼Œå…¶æ ¼å¼ä¹‹å¤šè®©äººç›®çœ©ã€‚è¿™é‡Œæˆ‘ä¹Ÿåªèƒ½ç®¡ä¸­çª¥è±¹äº†ï¼Œæ›´å¤šçš„ç”¨æ³•è¯·å‚çœ‹<a target="_blank" rel="noopener" href="http://php.net/manual/en/function.date.php">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><div class="post-button"><a class="btn" href="/2018/04/13/php-date-calculation/#more" rel="contents">ğŸ”¥ é˜…è¯»å…¨æ–‡ &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://imajinyun.xyz/2018/04/05/php-error-exception-handler/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><meta itemprop="name" content="ç¬”è€…å¶åƒ"><meta itemprop="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jinyun's Notes ğŸš€"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2018/04/05/php-error-exception-handler/" class="post-title-link" itemprop="url">PHP ä¸­çš„é”™è¯¯å’Œå¼‚å¸¸å¤„ç†</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-04-05 17:41:59" itemprop="dateCreated datePublished" datetime="2018-04-05T17:41:59+08:00">2018-04-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-01 10:37:02" itemprop="dateModified" datetime="2021-07-01T10:37:02+08:00">2021-07-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>PHP å½“ç„¶ä¹Ÿæœ‰è‡ªå·±çš„å¼‚å¸¸å¤„ç†ï¼Œä¸è¿‡é‚£å·²ç»æ˜¯ PHP5 ä»¥åçš„äº‹äº†ã€‚å°±æˆ‘è‡ªå·±è¿™äº›å¹´å†™ç¨‹åºçš„ç°çŠ¶çœ‹ï¼Œæˆ‘åŸºæœ¬ä¸Šå°±æ²¡æœ‰çœŸæ­£æ˜ç™½ä»€ä¹ˆæ˜¯å¼‚å¸¸å¤„ç†ï¼Œç»å¸¸æŠŠå¼‚å¸¸å’Œé”™è¯¯å¤„ç†æ··ä¸ºä¸€è°ˆï¼Œå…³äºä»£ç ä¸­çš„é‚£äº›å†™æ³•ï¼Œä¸æ˜¯å†™é”™äº†ï¼Œå°±æ˜¯å†™çš„å¤ªç‰¹ä¹ˆçƒ‚äº†ã€‚æ°å¥½æœ€è¿‘åœ¨å†™ä¸€äº›ç±»æ—¶ç”¨åˆ°å¼‚å¸¸å¤„ç†äº†ï¼Œé¡ºä¾¿å°±æŠŠè¿™ä¸ªæ•´ç†ä¸‹ï¼Œä½†æ˜¯è¿™ä¸ªä»…ä»£è¡¨æˆ‘ä¸ªäººçš„ä¸€äº›ç†è§£å’Œä½¿ç”¨ï¼Œä¹Ÿå¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œè¿˜è¯·è°¨æ…é˜…è¯»ã€‚</p><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><h2 id="é”™è¯¯å¤„ç†å®šä¹‰"><a href="#é”™è¯¯å¤„ç†å®šä¹‰" class="headerlink" title="é”™è¯¯å¤„ç†å®šä¹‰"></a>é”™è¯¯å¤„ç†å®šä¹‰</h2><p>é”™è¯¯æ˜¯æŒ‡å¯¼è‡´ç³»ç»Ÿä¸èƒ½æŒ‰ç…§ç”¨æˆ·æ„å›¾å·¥ä½œçš„ä¸€åˆ‡åŸå› ã€äº‹ä»¶ã€‚åœ¨ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œç”±äºæŸäº›é”™è¯¯çš„å­˜åœ¨ï¼Œè‡´ä½¿ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œï¼Œå¤„ç†è¿™äº›é”™è¯¯ä»¥ä½¿ç¨‹åºæ­£ç¡®è¿è¡Œå°±ç§°ä¸ºé”™è¯¯å¤„ç†ã€‚é”™è¯¯å¤„ç†åŠŸèƒ½æ˜¯è¡¡é‡ç¼–è¯‘å™¨æ€§èƒ½çš„é‡è¦æ–¹é¢ï¼Œå®ƒåœ¨å¸®åŠ©ç¨‹åºå‘˜å°½å¿«ä¿®æ”¹ç¨‹åºæ–¹é¢èµ·åˆ°äº†éå¸¸é‡è¦çš„ä½œç”¨ã€‚</p><p>é”™è¯¯ç±»å‹ï¼š</p><ul><li>è¯­æ³•é”™è¯¯</li><li>è¯­ä¹‰é”™è¯¯</li><li>é€»è¾‘é”™è¯¯</li></ul><h2 id="å¼‚å¸¸å¤„ç†å®šä¹‰"><a href="#å¼‚å¸¸å¤„ç†å®šä¹‰" class="headerlink" title="å¼‚å¸¸å¤„ç†å®šä¹‰"></a>å¼‚å¸¸å¤„ç†å®šä¹‰</h2><p>ç¼–ç¨‹è¯­è¨€æˆ–è®¡ç®—æœºç¡¬ä»¶é‡Œçš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºå¤„ç†è½¯ä»¶æˆ–ä¿¡æ¯ç³»ç»Ÿä¸­å‡ºç°çš„å¼‚å¸¸çŠ¶å†µï¼ˆå³è¶…å‡ºç¨‹åºæ­£å¸¸æ‰§è¡Œæµç¨‹çš„æŸäº›ç‰¹æ®Šæ¡ä»¶ï¼‰</p><h2 id="é¢„å®šä¹‰çš„é”™è¯¯ä»£ç "><a href="#é¢„å®šä¹‰çš„é”™è¯¯ä»£ç " class="headerlink" title="é¢„å®šä¹‰çš„é”™è¯¯ä»£ç "></a>é¢„å®šä¹‰çš„é”™è¯¯ä»£ç </h2><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥å‚è§å®˜ç½‘çš„æ‰‹å†Œ <strong><a target="_blank" rel="noopener" href="http://php.net/manual/zh/errorfunc.constants.php">é¢„å®šä¹‰å¸¸é‡</a></strong>ï¼Œæˆ‘æŠ„ä¸€éçº¯ç²¹æ˜¯ä¸ºäº†åŠ æ·±è®°å¿†ã€‚è‡³äºæ¯ç§é”™è¯¯åœ¨ä»€ä¹ˆæƒ…å†µä¸‹äº§ç”Ÿï¼Œä½ å¯ä»¥å‚çœ‹ <strong><a target="_blank" rel="noopener" href="http://www.cnblogs.com/yjf512/p/5314345.html">PHPçš„é”™è¯¯æœºåˆ¶æ€»ç»“</a></strong>ã€‚</p><table><thead><tr><th>å¸¸é‡</th><th>å–å€¼</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><code>E_ERROR</code></td><td>1</td><td>è‡´å‘½çš„è¿è¡Œæ—¶é”™è¯¯ã€‚è¿™ç±»é”™è¯¯ä¸€èˆ¬æ˜¯ä¸å¯æ¢å¤çš„æƒ…å†µï¼Œä¾‹å¦‚å†…å­˜åˆ†é…å¯¼è‡´çš„é—®é¢˜ã€‚åæœæ˜¯å¯¼è‡´è„šæœ¬ç»ˆæ­¢ä¸å†ç»§ç»­è¿è¡Œ</td><td></td></tr><tr><td><code>E_WARNING</code></td><td>2</td><td>è¿è¡Œæ—¶è­¦å‘Šï¼ˆéè‡´å‘½é”™è¯¯ï¼‰ã€‚ä»…ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œä½†æ˜¯è„šæœ¬ä¸ä¼šç»ˆæ­¢è¿è¡Œ</td><td></td></tr><tr><td><code>E_PARSE</code></td><td>4</td><td>ç¼–è¯‘æ—¶è¯­æ³•è§£æé”™è¯¯ã€‚è§£æé”™è¯¯ä»…ä»…ç”±åˆ†æå™¨äº§ç”Ÿ</td><td></td></tr><tr><td><code>E_NOTICE</code></td><td>8</td><td>è¿è¡Œæ—¶é€šçŸ¥ã€‚è¡¨ç¤ºè„šæœ¬é‡åˆ°å¯èƒ½ä¼šè¡¨ç°ä¸ºé”™è¯¯çš„æƒ…å†µï¼Œä½†æ˜¯åœ¨å¯ä»¥æ­£å¸¸è¿è¡Œçš„è„šæœ¬é‡Œé¢ä¹Ÿå¯èƒ½ä¼šæœ‰ç±»ä¼¼çš„é€šçŸ¥</td><td></td></tr><tr><td><code>E_CORE_ERROR</code></td><td>16</td><td>åœ¨ PHP åˆå§‹åŒ–å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿçš„è‡´å‘½é”™è¯¯ã€‚è¯¥é”™è¯¯ç±»ä¼¼ E_ERRORï¼Œä½†æ˜¯æ˜¯ç”± PHP å¼•æ“æ ¸å¿ƒäº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_CORE_WARNING</code></td><td>32</td><td>PHP åˆå§‹åŒ–å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿçš„è­¦å‘Šï¼ˆéè‡´å‘½é”™è¯¯ï¼‰ã€‚ç±»ä¼¼ E_WARNINGï¼Œä½†æ˜¯æ˜¯ç”± PHP å¼•æ“æ ¸å¿ƒäº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_COMPILE_ERROR</code></td><td>64</td><td>è‡´å‘½ç¼–è¯‘æ—¶é”™è¯¯ã€‚ç±»ä¼¼ E_ERRORï¼Œä½†æ˜¯æ˜¯ç”± Zend è„šæœ¬å¼•æ“äº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_COMPILE_WARNING</code></td><td>128</td><td>ç¼–è¯‘æ—¶è­¦å‘Šï¼ˆéè‡´å‘½é”™è¯¯ï¼‰ã€‚ç±»ä¼¼ E_WARNINGï¼Œä½†æ˜¯æ˜¯ç”± Zend è„šæœ¬å¼•æ“äº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_USER_ERROR</code></td><td>256</td><td>ç”¨æˆ·äº§ç”Ÿçš„é”™è¯¯ä¿¡æ¯ã€‚ç±»ä¼¼ E_ERRORï¼Œä½†æ˜¯æ˜¯ç”±ç”¨æˆ·è‡ªå·±åœ¨ä»£ç ä¸­ä½¿ç”¨ PHP å‡½æ•° trigger_error() æ¥äº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_USER_WARNING</code></td><td>512</td><td>ç”¨æˆ·äº§ç”Ÿçš„è­¦å‘Šä¿¡æ¯ã€‚ç±»ä¼¼ E_WARNINGï¼Œä½†æ˜¯æ˜¯ç”±ç”¨æˆ·è‡ªå·±åœ¨ä»£ç ä¸­ä½¿ç”¨ PHP å‡½æ•° trigger_error() æ¥äº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_USER_NOTICE</code></td><td>1024</td><td>ç”¨æˆ·äº§ç”Ÿçš„é€šçŸ¥ä¿¡æ¯ã€‚ç±»ä¼¼ E_NOTICEï¼Œä½†æ˜¯æ˜¯ç”±ç”¨æˆ·è‡ªå·±åœ¨ä»£ç ä¸­ä½¿ç”¨ PHP å‡½æ•° trigger_error() æ¥äº§ç”Ÿçš„</td><td>since PHP 4</td></tr><tr><td><code>E_STRICT</code></td><td>2048</td><td>å¯ç”¨ PHP å¯¹ä»£ç çš„ä¿®æ”¹å»ºè®®ï¼Œä»¥ç¡®ä¿ä»£ç å…·æœ‰æœ€ä½³çš„äº’æ“ä½œæ€§å’Œå‘å‰å…¼å®¹æ€§</td><td>since PHP 5</td></tr><tr><td><code>E_RECOVERABLE_ERROR</code></td><td>4096</td><td>å¯è¢«æ•æ‰çš„è‡´å‘½é”™è¯¯ã€‚å®ƒè¡¨ç¤ºå‘ç”Ÿäº†ä¸€ä¸ªå¯èƒ½éå¸¸å±é™©çš„é”™è¯¯ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¯¼è‡´ PHP å¼•æ“å¤„äºä¸ç¨³å®šçš„çŠ¶æ€ã€‚å¦‚æœè¯¥é”™è¯¯æ²¡æœ‰è¢«ç”¨æˆ·è‡ªå®šä¹‰å¥æŸ„æ•è·ï¼ˆå‚è§ set_error_handler()ï¼‰ï¼Œå°†æˆä¸ºä¸€ä¸ª E_ERRORã€€ä»è€Œè„šæœ¬ä¼šç»ˆæ­¢è¿è¡Œ</td><td>since PHP 5.2.0</td></tr><tr><td><code>E_DEPRECATED</code></td><td>8192</td><td>è¿è¡Œæ—¶é€šçŸ¥ã€‚å¯ç”¨åå°†ä¼šå¯¹åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œçš„ä»£ç ç»™å‡ºè­¦å‘Š</td><td>since PHP 5.3.0</td></tr><tr><td><code>E_USER_DEPRECATED</code></td><td>16384</td><td>ç”¨æˆ·äº§å°‘çš„è­¦å‘Šä¿¡æ¯ã€‚ç±»ä¼¼ E_DEPRECATEDï¼Œä½†æ˜¯æ˜¯ç”±ç”¨æˆ·è‡ªå·±åœ¨ä»£ç ä¸­ä½¿ç”¨ PHP å‡½æ•° trigger_error() æ¥äº§ç”Ÿçš„</td><td>since PHP 5.3.0</td></tr><tr><td><code>E_ALL</code></td><td>30719</td><td><code>E_STRICT</code> å‡ºå¤–çš„æ‰€æœ‰é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯</td><td>30719 in PHP 5.3.x, 6143 in PHP 5.2.x, 2047 previously</td></tr></tbody></table><div class="note danger"><ul><li>å¯ä»¥ä½¿ç”¨æŒ‰ä½è¿ç®—ç¬¦æ¥ç»„åˆè¿™äº›å€¼æˆ–è€…å±è”½æŸäº›ç±»å‹çš„é”™è¯¯ã€‚åœ¨ <code>php.ini</code> ä¹‹ä¸­ï¼Œä»… <code>|, ~, !, ^, &amp;</code> è¿™äº›æ“ä½œç¬¦ä¼šè¢«æ­£ç¡®è§£æ</li><li>ä»¥ä¸‹çº§åˆ«çš„é”™è¯¯ä¸èƒ½ç”±ç”¨æˆ·å®šä¹‰çš„å‡½æ•°æ¥å¤„ç†ï¼š<code>E_ERROR</code>ã€<code>E_PARSE</code>ã€<code>E_CORE_ERROR</code>ã€<code>E_CORE_WARNING</code>ã€<code>E_COMPILE_ERROR</code>ã€<code>E_COMPILE_WARNING</code> å’Œåœ¨è°ƒç”¨ <code>set_error_handler()</code> å‡½æ•°æ‰€åœ¨æ–‡ä»¶ä¸­äº§ç”Ÿçš„å¤§å¤šæ•° <code>E_STRICT</code></li></ul></div><h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><ul><li><a target="_blank" rel="noopener" href="http://www.laruence.com/2010/08/03/1697.html">æ·±å…¥ç†è§£PHPåŸç†ä¹‹å¼‚å¸¸æœºåˆ¶</a></li><li><a target="_blank" rel="noopener" href="http://www.laruence.com/2012/02/02/2515.html">æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨å¼‚å¸¸</a></li><li><a target="_blank" rel="noopener" href="https://laravel-china.org/articles/5435/exceptions-and-errors-in-php-best-practices">PHP æœ€ä½³å®è·µä¹‹å¼‚å¸¸å’Œé”™è¯¯</a></li><li><a target="_blank" rel="noopener" href="https://trowski.com/2015/06/24/throwable-exceptions-and-errors-in-php7/">Throwable Exceptions and Errors in PHP 7</a></li></ul><p>æ—©æœ‰äººæŠŠ PHP å„ä¸ªç‰ˆæœ¬çš„é”™è¯¯å’Œå¼‚å¸¸å¤„ç†ç±»æ ‘æ•´ç†å‡ºæ¥ä¾›æˆ‘ç­‰å‚è§‚ã€‚å¦‚æœåœ¨æœ¬åœ°æ‰§è¡Œæ­¤ä»£ç ï¼Œä¾æ®æœ¬åœ°å¯¹ PHP å®‰è£…çš„æ‰©å±•çš„ä¸åŒï¼Œä¼šæŠŠæ‰©å±•ä¸­çš„ç›¸å…³å¼‚å¸¸å¤„ç†ç±»ä¸€å¹¶æ‰“å°å‡ºæ¥</p><ul><li><a target="_blank" rel="noopener" href="https://gist.github.com/mlocati/249f07b074a0de339d4d1ca980848e6a">æ‰“å°é”™è¯¯å’Œå¼‚å¸¸å¤„ç†ç±»æ ‘ä»£ç </a></li><li><a target="_blank" rel="noopener" href="https://3v4l.org/sDMsv#output">æ‰“å°è¾“å‡ºç»“æœ</a></li></ul><h1 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h1><blockquote><ul><li>Note that other types of errors such as warnings and notices remain unchanged in PHP 7. Only fatal and recoverable errors throw exceptions.</li><li>Prior to PHP 7 alpha-2, the exception hierarchy in PHP 7 was different. Fatal and recoverable errors threw instances of EngineException, which did not inherit from Exception. Both Exception and EngineException inherited from BaseException. The hierarchy was revised with the RFC I authored, Throwable Interface. I felt switching to Throwable and Error was important to avoid confusion from classes using the suffix Exception that did not extend Exception, as well as being more concise and appealing names.</li></ul></blockquote><p><code>E_ERROR</code> å’Œ <code>E_RECOVERABLE_ERROR</code> çº§åˆ«çš„é”™è¯¯åœ¨ PHP7 ä¹‹å‰æ˜¯ä¸èƒ½è¢«æ•è·åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ— æ³•ä½¿ç”¨ <code>try...catch...</code> è¿™æ ·çš„è¯­å¥æ•è·åˆ°è¿™ç§çº§åˆ«çš„é”™è¯¯ï¼Œä½†ä¸ç®¡æ˜¯ PHP7 è¿˜æ˜¯ PHP5 å¯¹äºæœªæ•è·çš„å¼‚å¸¸ä¾ç„¶æ˜¯ä¸€ä¸ªè‡´å‘½é”™è¯¯</p><p>åœ¨ PHP5 ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$object</span>-&gt;method();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line">Fatal <span class="built_in">error</span>: Call to a member <span class="function"><span class="keyword">function</span> <span class="title">method</span>(<span class="params"></span>) <span class="title">on</span> <span class="title">null</span> <span class="title">in</span></span></span><br></pre></td></tr></table></figure><p>åœ¨ PHP7 ä¸­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$object</span>-&gt;method();</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$error</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$error</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line">Call to a member <span class="function"><span class="keyword">function</span> <span class="title">method</span>(<span class="params"></span>) <span class="title">on</span> <span class="title">null</span></span></span><br></pre></td></tr></table></figure><p>æ˜¯çš„ï¼ŒPHP7 å†…ç½®äº†ä¸€ä¸ªåä¸º <code>Error</code> çš„ç±»æ¥æ•è·ä¸€äº›è‡´å‘½é”™è¯¯å’Œå¼‚å¸¸äº†ï¼Œå…¶ä¸­ <code>Error</code> å’Œ <code>Exception</code> ç±»å®ç°äº† <code>Throwable</code> æ¥å£ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Throwable æ¥å£</span></span><br><span class="line"><span class="built_in">Throwable</span> &#123;</span><br><span class="line">    <span class="comment">/* Methods */</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">string</span> getMessage ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">int</span> getCode ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">string</span> getFile ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">int</span> getLine ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">array</span> getTrace ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">string</span> getTraceAsString ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="built_in">Throwable</span> getPrevious ( <span class="keyword">void</span> )</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">string</span> __toString ( <span class="keyword">void</span> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note danger"><p>å¼€å‘è€…ä¸èƒ½ç›´æ¥å®ç° <code>Throwable</code> æ¥å£ï¼Œå¿…é¡»é€šè¿‡ <code>Error</code> æˆ–è€… <code>Exception</code> ç­‰ç±»å»æ‰©å±•</p></div><p>ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹å¼å»æ‰©å±•è‡ªå·±çš„é”™è¯¯å’Œå¼‚å¸¸ç±»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">TestThrowable</span> <span class="keyword">extends</span> \<span class="title">Throwable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestException</span> <span class="keyword">extends</span> \<span class="title">Exception</span> <span class="keyword">implements</span> <span class="title">TestThrowable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoError</span> <span class="keyword">extends</span> \<span class="title">Error</span> <span class="keyword">implements</span> <span class="title">TestThrowable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h1><p>ç”±äº <code>Error</code> å’Œ <code>Exception</code> éƒ½å®ç°äº† <code>Throwable</code> æ¥å£ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œåœ¨ç¨‹åºä¸­æˆ‘ä»¬ç©¶ç«Ÿè¦ç”¨å“ªä¸ªï¼Ÿé€šè¿‡ä¸€äº›æœ€ä½³å®è·µæˆ‘ä»¬çŸ¥é“ï¼Œé”™è¯¯ä¸€èˆ¬æ˜¯å»çº¦æŸç¨‹åºå‘˜å’Œä»£ç è¯­æ³•ã€è¯­ä¹‰åŠé€»è¾‘æ–¹é¢çš„ï¼Œè€Œå¼‚å¸¸æ˜¯ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹å‡ºç°çš„ä¸€äº›ä¸åˆæœŸæœ›çš„æƒ…å†µã€‚å› æ­¤ï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬åº”å½“ä½¿ç”¨å¼‚å¸¸è€Œä¸æ˜¯é”™è¯¯ã€‚</p><p>PHP 7.2.0 - 7.2.3 ç‰ˆæœ¬ä¸­æä¾›çš„å†…ç½®å¼‚å¸¸ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Exception</span></span><br><span class="line">  ClosedGeneratorException</span><br><span class="line">  DOMException</span><br><span class="line">  <span class="built_in">ErrorException</span></span><br><span class="line">  IntlException</span><br><span class="line">  <span class="built_in">LogicException</span></span><br><span class="line">    <span class="built_in">BadFunctionCallException</span></span><br><span class="line">      <span class="built_in">BadMethodCallException</span></span><br><span class="line">    <span class="built_in">DomainException</span></span><br><span class="line">    <span class="built_in">InvalidArgumentException</span></span><br><span class="line">    <span class="built_in">LengthException</span></span><br><span class="line">    <span class="built_in">OutOfRangeException</span></span><br><span class="line">  PharException</span><br><span class="line">  ReflectionException</span><br><span class="line">  <span class="built_in">RuntimeException</span></span><br><span class="line">    <span class="built_in">OutOfBoundsException</span></span><br><span class="line">    <span class="built_in">OverflowException</span></span><br><span class="line">    PDOException</span><br><span class="line">    <span class="built_in">RangeException</span></span><br><span class="line">    <span class="built_in">UnderflowException</span></span><br><span class="line">    <span class="built_in">UnexpectedValueException</span></span><br><span class="line">  SodiumException</span><br></pre></td></tr></table></figure><p>å…¼å®¹ PHP5 å’Œ PHP7 çš„å¼‚å¸¸å¤„ç†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// Code that may throw an Exception or Error.</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$t</span>) &#123;</span><br><span class="line">    <span class="comment">// Executed only in PHP 7, will not match in PHP 5.x.</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="comment">// Executed only in PHP 5.x, will not be reached in PHP 7.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰æ•è·é”™è¯¯å’Œå¼‚å¸¸"><a href="#è‡ªå®šä¹‰æ•è·é”™è¯¯å’Œå¼‚å¸¸" class="headerlink" title="è‡ªå®šä¹‰æ•è·é”™è¯¯å’Œå¼‚å¸¸"></a>è‡ªå®šä¹‰æ•è·é”™è¯¯å’Œå¼‚å¸¸</h2><ul><li>æœªæ•è·çš„ <code>Error</code> å’Œ <code>Exception</code> é€šè¿‡ <code>set_exception_handler()</code> åšåç»­æ¸…ç†å’Œæ—¥å¿—è®°å½•</li><li>å…¶ä»–é”™è¯¯ä»ç„¶é€šè¿‡ <code>set_error_handler()</code> æ¥å¤„ç†ï¼Œåœ¨å¤„ç†çš„æ—¶å€™ä½¿ç”¨æ›´åŠ æ˜ç¡®çš„ <code>E_*</code> ç±»å‹ï¼Œå¹¶æŠ›å‡º <code>ErrorException</code> è®°å½•è°ƒç”¨æ ˆ</li></ul><p>ä»¥ä¸‹å®ä¾‹ä¸­ä½¿ç”¨ <code>set_error_handler()</code> å‡½æ•°å»æ•è·é”™è¯¯ï¼Œè®¾ç½®ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ï¼Œè¿™é‡Œæˆ‘å°±ç²—æš´çš„æŠ›å‡º äº† <code>ErrorException</code> å¼‚å¸¸ï¼Œå½“ç„¶å®˜æ–¹æ–‡æ¡£ä¹Ÿæ˜ç¡®è¯´äº†è¿™ä¸ªå‡½æ•°ä¸èƒ½æ•è· <code>E_ERROR</code>ã€<code>E_PARSE</code>ã€<code>E_CORE_ERROR</code>ã€<code>E_CORE_WARNING</code>ã€<code>E_COMPILE_ERROR</code>ã€<code>E_COMPILE_WARNING</code> å’Œåœ¨è°ƒç”¨ <code>set_error_handler()</code> å‡½æ•°æ‰€åœ¨æ–‡ä»¶ä¸­äº§ç”Ÿçš„å¤§å¤šæ•° <code>E_STRICT</code> å¼‚å¸¸ï¼Œè¨€å¤–ä¹‹è¯­ä¹Ÿå°±æ˜¯ä»…èƒ½æ•è·ç”¨æˆ·å®šä¹‰çš„é”™è¯¯å’Œå¼‚å¸¸ã€‚ä½¿ç”¨ <code>set_exception_handler()</code> å‡½æ•°å»è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œç”¨åœ¨æ²¡æœ‰ç”¨ <code>try/catch</code> å—æ¥æ•è·çš„å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ æŠ›å‡ºçš„å¼‚å¸¸æœ‰æ²¡æœ‰äººæ•è·ï¼Œå¦‚æœæ²¡æœ‰äººæ•è·å°±ä¼šè¿›å…¥åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”åœ¨å›è°ƒå‡½æ•°è°ƒç”¨åå¼‚å¸¸ä¼šä¸­æ­¢ã€‚ä½¿ç”¨ <code>register_shutdown_function()</code> å‡½æ•°å»æ•è· PHP çš„é”™è¯¯ï¼š<code>Fatal or Parse Error</code> ç­‰ï¼Œæ­£ç”±äºè¿™ä¸ªå‡½æ•°æ˜¯ PHP è„šæœ¬æ‰§è¡Œç»“æŸå‰çš„æœ€åä¸€ä¸ªæœ‰æ•ˆè°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰ç”¨å®ƒæ¥å®Œæˆä¸€äº›ä¸å¯æ€è®®çš„äº‹æƒ…ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½ä¼šåœ¨è¿™ä¸ªå‡½æ•°çš„å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨ <code>error_get_last()</code> å‡½æ•°æ¥è·å–æ‰§è¡Œäº§ç”Ÿçš„é”™è¯¯ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œåƒè¯­æ³•è¿™æ ·çš„é”™è¯¯æ˜¯æ•è·ä¸åˆ°çš„</p><h3 id="æ­£å¸¸æƒ…å†µæ—¶çš„å¼‚å¸¸æ•è·"><a href="#æ­£å¸¸æƒ…å†µæ—¶çš„å¼‚å¸¸æ•è·" class="headerlink" title="æ­£å¸¸æƒ…å†µæ—¶çš„å¼‚å¸¸æ•è·"></a>æ­£å¸¸æƒ…å†µæ—¶çš„å¼‚å¸¸æ•è·</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorHandler</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        error_reporting(E_ALL);</span><br><span class="line">        set_error_handler([<span class="keyword">__CLASS__</span>, <span class="string">&#x27;handleError&#x27;</span>]);</span><br><span class="line">        set_exception_handler([<span class="keyword">__CLASS__</span>, <span class="string">&#x27;handleException&#x27;</span>]);</span><br><span class="line">        register_shutdown_function([<span class="keyword">__CLASS__</span>, <span class="string">&#x27;handleShutdown&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">handleError</span>(<span class="params"><span class="variable">$code</span>, <span class="variable">$message</span>, <span class="variable">$file</span>, <span class="variable">$line</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="built_in">ErrorException</span>(<span class="variable">$message</span>, <span class="variable">$code</span>, <span class="number">1</span>, <span class="variable">$file</span>, <span class="variable">$line</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">handleException</span>(<span class="params"><span class="variable">$e</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">self</span>::handle(<span class="variable">$e</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">handleShutdown</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$error</span> = error_get_last();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> !== <span class="variable">$error</span> &amp;&amp; <span class="built_in">self</span>::isFatal(<span class="variable">$error</span>[<span class="string">&#x27;type&#x27;</span>])) &#123;</span><br><span class="line">            <span class="built_in">self</span>::handleException(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \Exception|\Throwable $e</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"><span class="variable">$e</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$message</span> = <span class="variable">$e</span>-&gt;getMessage() . PHP_EOL;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$message</span>;</span><br><span class="line"></span><br><span class="line">        error_log(<span class="variable">$message</span>, <span class="number">3</span>, <span class="keyword">__DIR__</span> . <span class="string">&#x27;/run.log&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">isFatal</span>(<span class="params"><span class="variable">$type</span></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$types</span> = [E_ERROR, E_CORE_ERROR, E_COMPILE_ERROR, E_PARSE];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> in_array(<span class="variable">$type</span>, <span class="variable">$types</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ErrorHandler::register();</span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$object</span>-&gt;toArray();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line">Call to a member <span class="function"><span class="keyword">function</span> <span class="title">toArray</span>(<span class="params"></span>) <span class="title">on</span> <span class="title">null</span></span></span><br><span class="line"><span class="function">æ­¤æ—¶é”™è¯¯å·²ç»è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­</span></span><br></pre></td></tr></table></figure><h3 id="å†™é”™è¯­æ³•æ—¶çš„å¼‚å¸¸æ•è·"><a href="#å†™é”™è¯­æ³•æ—¶çš„å¼‚å¸¸æ•è·" class="headerlink" title="å†™é”™è¯­æ³•æ—¶çš„å¼‚å¸¸æ•è·"></a>å†™é”™è¯­æ³•æ—¶çš„å¼‚å¸¸æ•è·</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤å¤„ç•¥å» ErrorHandler ç±»ä»£ç ï¼Œè¯¦è§ä¸Šé¢</span></span><br><span class="line">ErrorHandler::register();</span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™å„¿æ•…æ„ä¸å†™åˆ†å·</span></span><br><span class="line"><span class="variable">$object</span>-&gt;toArray()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æœ</span></span><br><span class="line">PHP Parse <span class="built_in">error</span>:  syntax <span class="built_in">error</span>, unexpected end of file in ...</span><br><span class="line">PHP</span><br><span class="line">PHP Dump <span class="variable">$_SERVER</span></span><br><span class="line">PHP</span><br><span class="line"></span><br><span class="line">Parse <span class="built_in">error</span>: syntax <span class="built_in">error</span>, unexpected end of file in ...</span><br></pre></td></tr></table></figure><p>äº‹æƒ…è¿›å±•åˆ°è¿™é‡Œï¼ŒæŒ‰ç†æ¥è¯´ï¼Œæˆ‘åº”è¯¥å°±æ­¤åœç¬”æ”¶å°¾ï¼Œå¼„ä¸ªæ€»ç»“ä¹‹ç±»çš„ä¸€å¿½æ‚ ä¸€ä¸‹æ­£åœ¨é˜…è¯»çš„ä½ ã€‚ä½†æ˜¯å‘¢ï¼Œæˆ‘åˆå¿½ç„¶æƒ³èµ·æ¥ PHP é‚£ä¹ˆå¤šçš„æ¡†æ¶æ˜¯å¦‚ä½•å¤„ç†è¿™ä¸ªäº‹æƒ…çš„ï¼Œæˆ‘æƒ³ä½ ä¹Ÿå¥½å¥‡ï¼Œä¸å¦¨æˆ‘ä»¬å»çœ‹çœ‹</p><h2 id="æ¡†æ¶ä¸­çš„é”™è¯¯å¼‚å¸¸å¤„ç†"><a href="#æ¡†æ¶ä¸­çš„é”™è¯¯å¼‚å¸¸å¤„ç†" class="headerlink" title="æ¡†æ¶ä¸­çš„é”™è¯¯å¼‚å¸¸å¤„ç†"></a>æ¡†æ¶ä¸­çš„é”™è¯¯å¼‚å¸¸å¤„ç†</h2><p>å¾ˆé—æ†¾çš„å‘Šè¯‰ä½ ï¼Œæˆ‘ä¸ä¼šå‰–ææ¡†æ¶æºç ï¼Œæˆ‘åªæƒ³åšä¸ª <code>demo</code> å¾—ç‘Ÿä¸€ä¸‹ï¼Œå‰©ä¸‹å…¨äº¤ç»™ä½ ã€‚æ­¤å¤„æˆ‘ä»¥ <code>symfony debug</code> ä¸ºä¾‹</p><blockquote><ul><li><a target="_blank" rel="noopener" href="https://github.com/symfony/debug">Symfony debug GitHub</a></li><li><a target="_blank" rel="noopener" href="https://symfony.com/components/Debug">Symfony debug Docs</a></li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£… symfony/debug</span><br><span class="line">$ composer require symfony/debug</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="keyword">__DIR__</span> . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">\Symfony\Component\Debug\Debug::enable();</span><br><span class="line">\Symfony\Component\Debug\ErrorHandler::register();</span><br><span class="line"></span><br><span class="line"><span class="variable">$object</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$object</span>-&gt;toArray();</span><br></pre></td></tr></table></figure><p><img src="https://inotes.oss-cn-beijing.aliyuncs.com/php/201812/php-error-exception-handler.png" alt="php-error-exception-handler.png"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://imajinyun.xyz/2018/03/18/php-highlight/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><meta itemprop="name" content="ç¬”è€…å¶åƒ"><meta itemprop="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jinyun's Notes ğŸš€"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2018/03/18/php-highlight/" class="post-title-link" itemprop="url">PHP - è¾“å‡ºä¸­çš„ä»£ç è¯­æ³•é«˜äº®</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-03-18 17:55:13" itemprop="dateCreated datePublished" datetime="2018-03-18T17:55:13+08:00">2018-03-18</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-01 10:37:02" itemprop="dateModified" datetime="2021-07-01T10:37:02+08:00">2021-07-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>ä»£ç é«˜äº®ä¸€ç›´ä»¥æ¥æ˜¯ç¨‹åºå‘˜çš„ä¸€é¡¹åŸºæœ¬è¯‰æ±‚ï¼Œå·²æˆä¸ºå„å¤§ç¼–è¾‘å™¨ã€IDE çš„æ ‡é…ã€‚å½“ç„¶è¿™ä¸ªèŒƒå›´å¯ä»¥å†æ‰©å¤§äº›ï¼Œç°åœ¨åŸºæœ¬ä¸Šæœ‰ä»£ç çš„åœ°æ–¹å°±æœ‰ä»£ç é«˜äº®äº†ï¼Œæ— è®ºä½ åœ¨å“ªæ¡èˆ¹ä¸Šã€‚å•¥ï¼Ÿä¸æ”¯æŒä»£ç é«˜äº®ï¼Œè¿™ä¸æ‰¯çŠŠå­å—ï¼Ÿä½œä¸ºä¸€ä¸ªæœ‰ç‚¹æ‰¯è°ˆçš„ç¨‹åºå‘˜ï¼Œæˆ‘å¯¹æ²¡æœ‰ä»£ç è¯­æ³•é«˜äº®çš„è¿™ä»¶äº‹æ˜¯åšå†³ä¸èƒ½å¿å—çš„ã€‚</p><div class="post-button"><a class="btn" href="/2018/03/18/php-highlight/#more" rel="contents">ğŸ”¥ é˜…è¯»å…¨æ–‡ &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://imajinyun.xyz/2018/03/07/php-phalcon-command/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><meta itemprop="name" content="ç¬”è€…å¶åƒ"><meta itemprop="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jinyun's Notes ğŸš€"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2018/03/07/php-phalcon-command/" class="post-title-link" itemprop="url">Phalcon æ¡†æ¶ä¹‹å‘½ä»¤è¡Œ</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-03-07 22:41:19" itemprop="dateCreated datePublished" datetime="2018-03-07T22:41:19+08:00">2018-03-07</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-01 10:37:02" itemprop="dateModified" datetime="2021-07-01T10:37:02+08:00">2021-07-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>è¿™å¹´å¤´å“ªä¸ªæ¡†æ¶è¦æ˜¯ä¸æä¾›å‘½ä»¤è¡Œäº¤äº’æ¥å£å’Œè„šæ‰‹æ¶ï¼Œå°±ä¸å¥½æ„æ€è‡ªç§°æ˜¯æ¡†æ¶ã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ªä¼˜ç§€çš„æ¡†æ¶æ€»ä¼šé¢é¢ä¿±åˆ°çš„ï¼Œæ¡†æ¶æœ¬æ¥å°±æ˜¯è®©å¼€å‘è€…å‡è½»è´Ÿæ‹…ï¼Œé¿å…é‡å¤é€ è½®å­çš„ï¼Œè®©å¼€å‘è€…ä¸“æ³¨ä¸šåŠ¡æœ¬èº«ï¼Œè€Œä¸æ˜¯æŠŠæ—¶é—´ç²¾åŠ›æ¶ˆè€—åœ¨ç£¨åˆ€ä¸Šé¢ã€‚å½“ç„¶è¿™æ˜¯æŸ„åŒåˆƒå‰‘ï¼Œç†æƒ³çš„çŠ¶æ€ç†åº”æ˜¯ä¸šåŠ¡æŠ€æœ¯å¹¶é©¾é½é©±ã€‚æ— è®ºæ˜¯å»ºé€ é’¢é“å¤§å¦çš„ <code>Symfony</code>ï¼Œè¿˜æ˜¯åˆ›é€ è‰ºæœ¯å®¶å›­ <code>Laravel</code>ï¼Œå…¶å‘½ä»¤è¡Œå¼ºå¤§çš„ä»¤äººæœ›è€Œå´æ­¥ã€‚å›è¿‡å¤´æ¥çœ‹ä¸€çœ‹é€Ÿåº¦ä¸æ¿€æƒ…çš„ <code>Phalcon</code> å§</p><h2 id="å®‰è£…å‘½ä»¤"><a href="#å®‰è£…å‘½ä»¤" class="headerlink" title="å®‰è£…å‘½ä»¤"></a>å®‰è£…å‘½ä»¤</h2><blockquote><ul><li><a target="_blank" rel="noopener" href="https://docs.phalconphp.com/en/latest/reference/tools.html">Phalcon Developer Tools for Offical Website</a></li><li><a target="_blank" rel="noopener" href="https://github.com/phalcon/phalcon-devtools">Phalcon Developer Tools for Official GitHub</a></li></ul></blockquote><h3 id="æŒ‡å®šçš„ç›®å½•"><a href="#æŒ‡å®šçš„ç›®å½•" class="headerlink" title="æŒ‡å®šçš„ç›®å½•"></a>æŒ‡å®šçš„ç›®å½•</h3><blockquote><p>å°† <code>phalcon</code> å‘½ä»¤åŠ å…¥åˆ°ç³»ç»Ÿ <code>PATH</code> å˜é‡ä¸­</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/phalcon/phalcon-devtools.git .phalcon-devtools</span><br><span class="line">$ <span class="built_in">cd</span> .phalcon-devtools</span><br><span class="line">$ ln -s ~/phalcon-devtools/phalcon.php /usr/<span class="built_in">local</span>/bin/phalcon</span><br><span class="line">$ chmod a+x /usr/<span class="built_in">local</span>/bin/phalcon</span><br><span class="line">æˆ–è€…</span><br><span class="line">$ <span class="built_in">cd</span> ~</span><br><span class="line">$ composer global require phalcon/devtools</span><br><span class="line">$ vim ~/.zshrc <span class="comment"># vim ~/.bashrc</span></span><br><span class="line">$ <span class="built_in">export</span> PATH=<span class="string">&quot;<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/.composer/vendor/bin/phalcon&quot;</span></span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><blockquote><p>æ”¯æŒçš„é¡¹ç›®ç±»å‹ï¼š<code>cli</code>ï¼Œ<code>micro</code>ï¼Œ<code>simple</code> - é»˜è®¤ï¼Œ<code>modules</code>ï¼Œå…± <code>4</code> ç§ç±»å‹çš„é¡¹ç›®</p></blockquote><h3 id="å¯ç”¨å‘½ä»¤ä¸€è§ˆ"><a href="#å¯ç”¨å‘½ä»¤ä¸€è§ˆ" class="headerlink" title="å¯ç”¨å‘½ä»¤ä¸€è§ˆ"></a>å¯ç”¨å‘½ä»¤ä¸€è§ˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon</span><br><span class="line"></span><br><span class="line">Phalcon DevTools (3.2.12)</span><br><span class="line"></span><br><span class="line">Available commands:</span><br><span class="line">  info             (<span class="built_in">alias</span> of: i)</span><br><span class="line">  commands         (<span class="built_in">alias</span> of: list, enumerate)</span><br><span class="line">  controller       (<span class="built_in">alias</span> of: create-controller)</span><br><span class="line">  module           (<span class="built_in">alias</span> of: create-module)</span><br><span class="line">  model            (<span class="built_in">alias</span> of: create-model)</span><br><span class="line">  all-models       (<span class="built_in">alias</span> of: create-all-models)</span><br><span class="line">  project          (<span class="built_in">alias</span> of: create-project)</span><br><span class="line">  scaffold         (<span class="built_in">alias</span> of: create-scaffold)</span><br><span class="line">  migration        (<span class="built_in">alias</span> of: create-migration)</span><br><span class="line">  webtools         (<span class="built_in">alias</span> of: create-webtools)</span><br><span class="line">  serve            (<span class="built_in">alias</span> of: server)</span><br><span class="line">  console          (<span class="built_in">alias</span> of: shell, psysh)</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºé»˜è®¤é¡¹ç›®"><a href="#åˆ›å»ºé»˜è®¤é¡¹ç›®" class="headerlink" title="åˆ›å»ºé»˜è®¤é¡¹ç›®"></a>åˆ›å»ºé»˜è®¤é¡¹ç›®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// åˆ›å»ºä¸€ä¸ª `cli` ç±»å‹çš„é¡¹ç›®</span><br><span class="line">$ phalcon project cli</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºä¸€ä¸ª `micro` ç±»å‹çš„é¡¹ç›®</span><br><span class="line">$ phalcon project micro</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºä¸€ä¸ª `simple` ç±»å‹çš„é¡¹ç›®</span><br><span class="line">$ phalcon project simple</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºä¸€ä¸ª `modules` ç±»å‹çš„é¡¹ç›®</span><br><span class="line">$ phalcon project modules</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå®šåˆ¶é¡¹ç›®"><a href="#åˆ›å»ºå®šåˆ¶é¡¹ç›®" class="headerlink" title="åˆ›å»ºå®šåˆ¶é¡¹ç›®"></a>åˆ›å»ºå®šåˆ¶é¡¹ç›®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon project --name example --enable-webtools --directory ./ --<span class="built_in">type</span> simple --use-config-ini --trace</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹"><a href="#åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹" class="headerlink" title="åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹"></a>åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹</h2><h3 id="åœ¨åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹æ—¶ï¼Œå…ˆæ³¨å†Œå‘½åç©ºé—´"><a href="#åœ¨åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹æ—¶ï¼Œå…ˆæ³¨å†Œå‘½åç©ºé—´" class="headerlink" title="åœ¨åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹æ—¶ï¼Œå…ˆæ³¨å†Œå‘½åç©ºé—´"></a>åœ¨åˆ›å»ºæ§åˆ¶å™¨å’Œæ¨¡å‹æ—¶ï¼Œå…ˆæ³¨å†Œå‘½åç©ºé—´</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// loader.php</span></span><br><span class="line"><span class="variable">$loader</span> = <span class="keyword">new</span> \Phalcon\Loader();</span><br><span class="line"></span><br><span class="line"><span class="variable">$loader</span>-&gt;registerNamespaces([</span><br><span class="line">    <span class="string">&#x27;App\\Controller&#x27;</span> =&gt; <span class="string">&#x27;../app/controllers&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;App\\Model&#x27;</span>      =&gt; <span class="string">&#x27;../app/models&#x27;</span>,</span><br><span class="line">])-&gt;register();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * We&#x27;re a registering a set of directories taken from the configuration file.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$loader</span>-&gt;registerDirs([</span><br><span class="line">    <span class="variable">$config</span>-&gt;application-&gt;controllersDir,</span><br><span class="line">    <span class="variable">$config</span>-&gt;application-&gt;modelsDir,</span><br><span class="line">])-&gt;register();</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæ§åˆ¶å™¨"><a href="#åˆ›å»ºæ§åˆ¶å™¨" class="headerlink" title="åˆ›å»ºæ§åˆ¶å™¨"></a>åˆ›å»ºæ§åˆ¶å™¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon controller --name article --base-class ControllerBase --force</span><br><span class="line">æˆ–è€…</span><br><span class="line">$ phalcon controller --name article --namespace App\\Controller --base-class ControllerBase --force</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºæ¨¡å‹"><a href="#åˆ›å»ºæ¨¡å‹" class="headerlink" title="åˆ›å»ºæ¨¡å‹"></a>åˆ›å»ºæ¨¡å‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon model --name user</span><br><span class="line">æˆ–è€…</span><br><span class="line">$ phalcon model --name users --namespace App\\Model --get-set --doc --force --camelize --trace --mapcolumn --annotate</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºè¿ç§»"><a href="#åˆ›å»ºè¿ç§»" class="headerlink" title="åˆ›å»ºè¿ç§»"></a>åˆ›å»ºè¿ç§»</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon migration --action=generate --config=./app/config/config.php --version=1.0.0 --descr=init --force</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºè„šæ‰‹æ¶"><a href="#åˆ›å»ºè„šæ‰‹æ¶" class="headerlink" title="åˆ›å»ºè„šæ‰‹æ¶"></a>åˆ›å»ºè„šæ‰‹æ¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon scaffold --table-name=user --get-set --force --trace</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œå†…ç½®æœåŠ¡å™¨"><a href="#è¿è¡Œå†…ç½®æœåŠ¡å™¨" class="headerlink" title="è¿è¡Œå†…ç½®æœåŠ¡å™¨"></a>è¿è¡Œå†…ç½®æœåŠ¡å™¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon serve --hostname=127.0.0.1 --port=8080 --basepath=.htrouter.php --rootpath=public</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p><a target="_blank" rel="noopener" href="https://forum.phalconphp.com/discussion/4448/error-sqlstatehy000-2002-no-such-file-or-directory">Error: SQLSTATE[HY000] [2002] No such file or directory</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç¼–è¾‘ php.ini æ–‡ä»¶ä¸­çš„ PDO é»˜è®¤ socket</span><br><span class="line">$ pdo_mysql.default_socket=/usr/<span class="built_in">local</span>/var/run/mysql/mysql.sock</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> æŸ¥è¯¢ socket å˜é‡</span><br><span class="line">$ <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%socket%&#x27;</span>;</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://imajinyun.xyz/2018/03/06/php-phalcon-bootstrap/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><meta itemprop="name" content="ç¬”è€…å¶åƒ"><meta itemprop="description" content="è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Jinyun's Notes ğŸš€"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/2018/03/06/php-phalcon-bootstrap/" class="post-title-link" itemprop="url">Phalcon æ¡†æ¶ä¹‹å¯åŠ¨æµç¨‹</a></h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2018-03-06 14:24:26" itemprop="dateCreated datePublished" datetime="2018-03-06T14:24:26+08:00">2018-03-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-07-01 10:37:02" itemprop="dateModified" datetime="2021-07-01T10:37:02+08:00">2021-07-01</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/php/" itemprop="url" rel="index"><span itemprop="name">php</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><p>ç¨€é‡Œç³Šæ¶‚çš„ä½¿ç”¨ <code>Phalcon</code> ä¸€å¹´å¤šäº†ï¼Œå¯¹äºå…¶è¿è¡Œçš„çš„æµç¨‹ä¹ŸçŸ¥é“ä¸ªå¤§æ¦‚ï¼Œæœ¬æ¥è®¡åˆ’å°½æ—©æ¢³ç†ä¸€ä¸‹ï¼Œæ•´ç†ä¸‹å­¦ä¹ å¿ƒå¾—ï¼Œä½†æ˜¯ï¼Œç”±äºç§ç§åŸå› è¿˜æ˜¯æ²¡å¥½å¥½æ•´ç†è®°å½•ã€‚å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œå†ç»è¿‡æ¥æ¥å›å›ç¿»æ–‡æ¡£è¿‡ç¨‹ä¸­æ„ˆåŠ ç—›æ¨è‡ªå·±çš„è®°å¿†åŠ›äº†ï¼Œæ–‡æ¡£ä¸Šæ‰¾èµ·æ¥ä¹Ÿä¸è§å¾—å®¹æ˜“ï¼Œè¿˜æ˜¯è€è€å®å®è®°å½•ä¸€ä¸‹å¸¸ç”¨çš„ä¸€äº›ä¸œè¥¿å§ï¼Œè¿™æ ·åœ¨ä¸€ä¸ªåœ°æ–¹æ‰¾æ€»èƒœè¿‡åœ¨ä¸€ä¸ªåºå¤§çš„æ‰‹å†Œè·³æ¥è·³å»å§ã€‚é¡ºä¾¿æä¸€ä¸‹ï¼Œ<a target="_blank" rel="noopener" href="https://docs.phalconphp.com/en/3.3/introduction"><code>Phalcon</code></a> çš„å®˜æ–¹æ–‡æ¡£è¶Šæ¥è¶Šå¥½ç”¨äº†ã€‚</p><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h2><p>æ‰§è¡Œä»¥ä¸‹çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ ‡å‡†çš„ <code>Phalcon Micro Project</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ phalcon project --name example --enable-webtools --directory ./ --<span class="built_in">type</span> micro --use-config-ini --trace</span><br></pre></td></tr></table></figure><p>å…¥å£æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Phalcon</span>\<span class="title">Di</span>\<span class="title">FactoryDefault</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Phalcon</span>\<span class="title">Mvc</span>\<span class="title">Micro</span>;</span><br><span class="line"></span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line"></span><br><span class="line">define(<span class="string">&#x27;BASE_PATH&#x27;</span>, dirname(<span class="keyword">__DIR__</span>));</span><br><span class="line">define(<span class="string">&#x27;APP_PATH&#x27;</span>, BASE_PATH . <span class="string">&#x27;/app&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The FactoryDefault Dependency Injector automatically registers the services that</span></span><br><span class="line"><span class="comment">     * provide a full stack framework. These default services can be overidden with custom ones.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable">$di</span> = <span class="keyword">new</span> FactoryDefault();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Include Services</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">include</span> APP_PATH . <span class="string">&#x27;/config/services.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get config service for use in inline setup below</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable">$config</span> = <span class="variable">$di</span>-&gt;getConfig();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Include Autoloader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">include</span> APP_PATH . <span class="string">&#x27;/config/loader.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Starting the application</span></span><br><span class="line"><span class="comment">     * Assign service locator to the application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable">$app</span> = <span class="keyword">new</span> Micro(<span class="variable">$di</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Include Application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">include</span> APP_PATH . <span class="string">&#x27;/app.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Handle the request</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="variable">$app</span>-&gt;handle();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (\<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;getMessage() . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . <span class="variable">$e</span>-&gt;getTraceAsString() . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯</p><ul><li>åˆ›å»ºä¾èµ–æ³¨å…¥å®¹å™¨</li><li>å¼•å…¥æœåŠ¡ï¼Œå°†ä¾èµ–åŠæœåŠ¡æ”¶é›†åˆ°å®¹å™¨ä¸­</li><li>è‡ªåŠ¨åŠ è½½</li><li>å°†å®¹å™¨æ³¨å…¥ç»™åº”ç”¨ç¨‹åº</li><li>è¯·æ±‚å¤„ç†å¹¶å“åº”</li></ul><h2 id="ä¾èµ–æ³¨å†Œ"><a href="#ä¾èµ–æ³¨å†Œ" class="headerlink" title="ä¾èµ–æ³¨å†Œ"></a>ä¾èµ–æ³¨å†Œ</h2><h3 id="ç³»ç»Ÿé»˜è®¤æ³¨å†Œ"><a href="#ç³»ç»Ÿé»˜è®¤æ³¨å†Œ" class="headerlink" title="ç³»ç»Ÿé»˜è®¤æ³¨å†Œ"></a>ç³»ç»Ÿé»˜è®¤æ³¨å†Œ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Include Services</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">include</span> APP_PATH . <span class="string">&#x27;/config/services.php&#x27;</span>;</span><br></pre></td></tr></table></figure><p><code>services.php</code> é»˜è®¤æ³¨å†Œäº† é…ç½® - <code>\Phalcon\Config\Adapter\Ini(ConfigFile)</code>, è§†å›¾ - <code>Phalcon\Mvc\View\Simple</code>, <code>URL</code> - <code>Phalcon\Mvc\Url</code> å’Œ <code>Phalcon\Db\Adapter\Pdo\XxxAdapter</code> è¿™å››ä¸ªç»„ä»¶ï¼ŒåŒæ—¶å½“åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œ<code>DI</code> ä¸­é»˜è®¤æ³¨å†Œäº†å…¶å®ƒæœåŠ¡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$services</span> = <span class="variable">$app</span>-&gt;getDI()-&gt;getServices();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$services</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$service</span>) &#123;</span><br><span class="line">    var_dump(<span class="variable">$key</span>);</span><br><span class="line">    var_dump(get_class(<span class="variable">$app</span>-&gt;getDI()-&gt;get(<span class="variable">$key</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåçš„ <code>Phalcon</code> æ³¨å†ŒæœåŠ¡å¦‚ä¸‹ï¼š</p><blockquote><p>å…¶ä¸­ <code>url</code>ã€<code>config</code>ã€<code>view</code>ã€<code>db</code>ã€<code>application</code> æ˜¯æ²¡æœ‰å¯¹åº”çš„ä¾èµ–æœåŠ¡çš„</p></blockquote><ul><li><code>router - Phalcon\Mvc\Router</code>: è·¯ç”±</li><li><code>dispatcher - Phalcon\Mvc\Dispatcher</code>: è°ƒåº¦ï¼Œå°†è·¯ç”±å‘½ä¸­çš„ç»“æœåˆ†å‘åˆ°å¯¹åº”çš„å¤„ç†å•å…ƒä¸Š</li><li><code>url - Phalcon\Mvc\Url</code>: è§£æç”Ÿæˆ <code>URL</code></li><li><code>modelsManager - Phalcon\Mvc\Model\Manager</code>: æ¨¡å‹ç®¡ç†å™¨</li><li><code>modelsMetadata - Phalcon\Mvc\Model\MetaData\Memory</code>: <code>ORM</code> æ˜ å°„</li><li><code>response - Phalcon\Http\Response</code>: å“åº”</li><li><code>cookies - Phalcon\Http\Response\Cookies</code>: <code>Cookies</code></li><li><code>request - Phalcon\Http\Request</code>: è¯·æ±‚</li><li><code>filter - Phalcon\Filter</code>: è¿‡æ»¤å™¨</li><li><code>escaper - Phalcon\Escaper</code>: è½¬ä¹‰å·¥å…·</li><li><code>security - Phalcon\Security</code>: å®‰å…¨å·¥å…·(å¯†ç  <code>Hash</code>ã€<code>CRSF</code> ä¿æŠ¤)</li><li><code>crypt - Phalcon\Crypt</code>: å¯†ç å·¥å…·</li><li><code>annotations - Phalcon\Annotations\Adapter\Memory</code>: æ³¨é‡Šåˆ†æ</li><li><code>flash - Phalcon\Flash\Direct</code>: æç¤ºä¿¡æ¯è¾“å‡º</li><li><code>flashSession - Phalcon\Flash\Session</code>: æç¤ºä¿¡æ¯é€šè¿‡ <code>Session</code> å»¶è¿Ÿè¾“å‡º</li><li><code>tag - Phalcon\Tag</code>: è§†å›¾åŠ©æ‰‹</li><li><code>session - Phalcon\Session\Adapter\Files</code>: <code>Session</code></li><li><code>sessionBag - Phalcon\Session\Bag</code>: <code>Session</code> åŒ…</li><li><code>eventsManager - Phalcon\Events\Manager</code>: äº‹ä»¶</li><li><code>transactionManager - Phalcon\Mvc\Model\Transaction\Manager</code>: äº‹åŠ¡</li><li><code>assets - Phalcon\Assets\Manager</code>: èµ„äº§</li><li><code>config - \Phalcon\Config\Adapter\Ini(ConfigFile)</code>: é…ç½®</li><li><code>view - Phalcon\Mvc\View\Simple</code>: è§†å›¾</li><li><code>db - Phalcon\Db\Adapter\Pdo\Mysql</code>: æ•°æ®åº“ï¼Œå¯é€‰(<code>MySQL</code>ã€<code>Postgresql</code> ç­‰)</li><li><code>application - Phalcon\Mvc\Micro</code>: åº”ç”¨</li></ul><h3 id="ä¾èµ–æ³¨å†Œå±æ€§çš„æ”¹å˜"><a href="#ä¾èµ–æ³¨å†Œå±æ€§çš„æ”¹å˜" class="headerlink" title="ä¾èµ–æ³¨å†Œå±æ€§çš„æ”¹å˜"></a>ä¾èµ–æ³¨å†Œå±æ€§çš„æ”¹å˜</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Set routing capabilities</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$router</span> = <span class="variable">$app</span>-&gt;getDI()-&gt;get(<span class="string">&#x27;router&#x27;</span>);</span><br><span class="line"><span class="variable">$router</span>-&gt;setUriSource(\Phalcon\Mvc\Router::URI_SOURCE_SERVER_REQUEST_URI);</span><br></pre></td></tr></table></figure><h2 id="æ¨¡å—æ³¨å†Œ"><a href="#æ¨¡å—æ³¨å†Œ" class="headerlink" title="æ¨¡å—æ³¨å†Œ"></a>æ¨¡å—æ³¨å†Œ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Composer autoloader</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">require</span> BASE_PATH . <span class="string">&#x27;/vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Registering an autoloader</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$loader</span> = <span class="keyword">new</span> \Phalcon\Loader();</span><br><span class="line"></span><br><span class="line"><span class="variable">$loader</span>-&gt;registerNamespaces([</span><br><span class="line">    <span class="string">&#x27;App\\Model&#x27;</span>     =&gt; <span class="string">&#x27;../app/models&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;App\\Component&#x27;</span> =&gt; <span class="string">&#x27;../app/components&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;App\\Util&#x27;</span>      =&gt; <span class="string">&#x27;../app/utils&#x27;</span>,</span><br><span class="line">])-&gt;register();</span><br><span class="line"></span><br><span class="line"><span class="variable">$loader</span>-&gt;registerDirs([</span><br><span class="line">    <span class="variable">$config</span>-&gt;application-&gt;modelsDir,</span><br><span class="line">])-&gt;register();</span><br></pre></td></tr></table></figure><p>æ¨¡å—æ³¨å†Œï¼Œå…¶å®å°±æ˜¯å‘Šè¯‰åº”ç”¨ç¨‹åºéœ€è¦å¼•å¯¼çš„æ¨¡å—è·¯å¾„å’Œç±»å</p><h2 id="MVC-åˆ†å±‚"><a href="#MVC-åˆ†å±‚" class="headerlink" title="MVC åˆ†å±‚"></a><code>MVC</code> åˆ†å±‚</h2><blockquote><ul><li>æ­¤å¤„çš„ <code>$app</code> æŒ‡çš„å°±æ˜¯åˆ›å»ºçš„ <code>Micro</code> å¯¹è±¡ï¼Œä¸€å¼€å§‹æˆ‘ä»¬åˆ›å»ºçš„åº”ç”¨ç±»å‹ä¸º <code>Phalcon Micro Project</code></li><li><code>$app-&gt;handle();</code> æ˜¯æ•´ä¸ª <code>MVC</code> çš„æ ¸å¿ƒï¼Œè¿™ä¸ªæ–¹æ³•å¤„ç†äº† <code>MVC</code> çš„å…¨éƒ¨æµç¨‹ï¼Œå®ƒè·å¾—æ‰€æœ‰è¯·æ±‚åï¼Œåœ¨å¤„ç†è¿‡ç¨‹ä¸­é€šè¿‡äº‹ä»¶é©±åŠ¨è§¦å‘ä¸€ç³»åˆ—çš„ <code>app</code> äº‹ä»¶ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªå®Œæ•´çš„ <code>Phalcon\Http\Response</code> å¯¹è±¡</li></ul></blockquote><h3 id="è‡ªæ£€"><a href="#è‡ªæ£€" class="headerlink" title="è‡ªæ£€"></a>è‡ªæ£€</h3><p>è¿™ä¸ªé˜¶æ®µï¼Œä¸»è¦æ£€æŸ¥ <code>DI</code>ï¼Œç¡®ä¿å¿…è¦çš„æœåŠ¡æ³¨å†Œè¿›æ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœå°† `db` æœåŠ¡æ³¨é‡Šæ‰ï¼Œä¼šæŠ›å‡ºä¸‹é¢çš„å¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Database connection is created based in the parameters defined in the configuration file</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// $di-&gt;setShared(&#x27;db&#x27;, function () &#123;</span></span><br><span class="line"><span class="comment">//     $config = $this-&gt;getConfig();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     $class = &#x27;Phalcon\Db\Adapter\Pdo\\&#x27; . $config-&gt;database-&gt;adapter;</span></span><br><span class="line"><span class="comment">//     $params = [</span></span><br><span class="line"><span class="comment">//         &#x27;host&#x27;     =&gt; $config-&gt;database-&gt;host,</span></span><br><span class="line"><span class="comment">//         &#x27;username&#x27; =&gt; $config-&gt;database-&gt;username,</span></span><br><span class="line"><span class="comment">//         &#x27;password&#x27; =&gt; $config-&gt;database-&gt;password,</span></span><br><span class="line"><span class="comment">//         &#x27;dbname&#x27;   =&gt; $config-&gt;database-&gt;dbname,</span></span><br><span class="line"><span class="comment">//         &#x27;charset&#x27;  =&gt; $config-&gt;database-&gt;charset,</span></span><br><span class="line"><span class="comment">//     ];</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     if ($config-&gt;database-&gt;adapter == &#x27;Postgresql&#x27;) &#123;</span></span><br><span class="line"><span class="comment">//         unset($params[&#x27;charset&#x27;]);</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     $connection = new $class($params);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     return $connection;</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">Service <span class="string">&#x27;db&#x27;</span> wasn<span class="string">&#x27;t found in the dependency injection container</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œ<code>app</code> å¯ä»¥æŠŠäº‹ä»¶ç»‘å®šåˆ° <code>Phalcon\Events\Manager</code> ä¸Š</p><table><thead><tr><th>äº‹ä»¶åç§°</th><th>è§¦å‘ç‚¹</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td><code>boot</code></td><td>å½“åº”ç”¨å¤„ç†å®ƒé¦–ä¸ªè¯·æ±‚æ—¶è¢«æ‰§è¡Œ</td><td></td></tr><tr><td><code>beforeStartModule</code></td><td>åˆå§‹åŒ–æ¨¡å—ä¹‹å‰ï¼Œä»…å½“æ¨¡å—è¢«æ³¨å†Œæ—¶</td><td></td></tr><tr><td><code>afterStartModule</code></td><td>åˆå§‹åŒ–æ¨¡å—ä¹‹åï¼Œä»…å½“æ¨¡å—è¢«æ³¨å†Œæ—¶</td><td></td></tr><tr><td><code>beforeHandleRequest</code></td><td>è°ƒåº¦åˆ†å‘å¾ªç¯ä¹‹å‰</td><td></td></tr><tr><td><code>afterHandleRequest</code></td><td>è°ƒåº¦åˆ†å‘å¾ªç¯ä¹‹å</td></tr></tbody></table><p>å°†ä¸€ä¸ªäº‹ä»¶ç»‘å®šåˆ°äº‹ä»¶ç®¡ç†å™¨ä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Phalcon</span>\<span class="title">Events</span>\<span class="title">Event</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Phalcon</span>\<span class="title">Events</span>\<span class="title">Manager</span> <span class="title">as</span> <span class="title">EventsManager</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$eventsManager</span> = <span class="keyword">new</span> EventsManager();</span><br><span class="line"></span><br><span class="line"><span class="variable">$application</span>-&gt;setEventsManager(<span class="variable">$eventsManager</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$eventsManager</span>-&gt;attach(</span><br><span class="line">    <span class="string">&quot;application&quot;</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">Event <span class="variable">$event</span>, <span class="variable">$application</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>åšå®Œè¿™äº›è‡ªæ£€åï¼Œå°±é¡ºå¾—åœ°è¿›å…¥äº†è·¯ç”±é˜¶æ®µ</p><h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h3><p>ä» <code>DI</code> ä¸­å®¹å™¨ä¸­é€šè¿‡é”®å <code>router</code> è·å–è·¯ç”±æœåŠ¡ï¼Œå°† <code>uri</code> ä¼ å…¥è·¯ç”±å¹¶è°ƒç”¨è·¯ç”±çš„ <code>handle()</code> æ–¹æ³•</p><p>è·¯ç”±çš„ <code>handle()</code> æ–¹æ³•ä¹Ÿæ˜¯å¥½è„¾æ°”ï¼Œè´Ÿè´£æŠŠå°†è¯·æ±‚ä¸­çš„åŸå§‹ <code>uri</code> æ£€æŸ¥(è·¯ç”±æ˜¯å¦å‘½ä¸­)è§£æåï¼Œè½¬æ¢ä¸ºå¯¹åº”çš„ <code>Module</code>ï¼Œ<code>Controller</code>ï¼Œ<code>Action</code> ç­‰ï¼Œå¹¶é€šè¿‡ <code>$router-&gt;getModuleName()</code> è·å–æ¨¡å—åï¼Œåˆ¤æ–­æ¨¡å—æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±åŠ è½½ç›¸åº”çš„æ¨¡å—å¯åŠ¨æ¨¡å—ï¼Œå¦åˆ™ï¼Œå°±ç›´æ¥è¿›å…¥åˆ°è·¯ç”±çš„åˆ†å‘é˜¶æ®µ</p><h3 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h3><p>ä¹‹å‰ç»‘å®šåˆ°äº‹ä»¶ç®¡ç†å™¨ä¸Šäº‹ä»¶å°±ä¼šå› ä¸ºæŒ‡å®šçš„è·¯ç”±è€Œè§¦å‘ï¼Œäº‹ä»¶è§¦å‘åæ£€æŸ¥æ¨¡å—çš„æ­£ç¡®æ€§ï¼Œæ ¹æ®æ¨¡å—æ–‡ä»¶ä¸­å®šä¹‰çš„ <code>className</code>ï¼Œ<code>path</code> ç­‰ï¼Œå°†æ¨¡å—å¼•å¯¼æ–‡ä»¶åŠ è½½è¿›æ¥ï¼Œå¹¶è°ƒç”¨æ¨¡å—å¼•å¯¼æ–‡ä»¶ä¸­å¿…é¡»å­˜åœ¨çš„æ–¹æ³•. ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªå®šä¹‰çš„æ¨¡å—å¿…é¡»å®ç° <code>ModuleDefinitionInterface</code> å®šä¹‰çš„ <code>registerAutoloaders(\Phalcon\DiInterface $dependencyInjector = null)</code> å’Œ <code>registerServices(\Phalcon\DiInterface $dependencyInjector)</code> æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Phalcon</span>\<span class="title">Mvc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Phalcon\Mvc\ModuleDefinitionInterface</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This interface must be implemented by class module definitions</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">ModuleDefinitionInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Registers an autoloader related to the module</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \Phalcon\DiInterface $dependencyInjector</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">registerAutoloaders</span>(<span class="params">\Phalcon\DiInterface <span class="variable">$dependencyInjector</span> = <span class="literal">null</span></span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Registers services related to the module</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \Phalcon\DiInterface $dependencyInjector</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">registerServices</span>(<span class="params">\Phalcon\DiInterface <span class="variable">$dependencyInjector</span></span>)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡å—å¯åŠ¨å®Œæˆåè§¦å‘ <code>afterStartModule</code> äº‹ä»¶ï¼Œæ ‡å¿—ç€æ­£å¼è¿›å…¥è·¯ç”±çš„è°ƒåº¦åˆ†å‘é˜¶æ®µ</p><h3 id="åˆ†å‘"><a href="#åˆ†å‘" class="headerlink" title="åˆ†å‘"></a>åˆ†å‘</h3><p><code>Phalcon</code> çš„è·¯ç”±è°ƒåº¦åˆ†å‘æ˜¯ç”± <code>Phalcon\Mvc\Dispatcher</code> æ¥å®Œæˆ. æ‰€è°“åˆ†å‘ï¼Œå°±æ˜¯ <code>Phalcon</code> æ ¹æ®è¯·æ±‚çš„åŸå§‹ <code>uri</code>ï¼Œå°†å…¶åŒ¹é…åˆ°çš„åœ°å€è§£æåˆ°å¯¹åº”çš„ <code>Controller</code> åŠ <code>Action</code>ï¼Œå¹¶è¿”å› <code>Action</code> ç»“æœ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Phalcon</span>\<span class="title">Mvc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Phalcon\Mvc\Dispatcher</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Dispatching is the process of taking the request object, extracting the module name,</span></span><br><span class="line"><span class="comment"> * controller name, action name, and optional parameters contained in it, and then</span></span><br><span class="line"><span class="comment"> * instantiating a controller and calling an action of that controller.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;code&gt;</span></span><br><span class="line"><span class="comment"> * $di = new \Phalcon\Di();</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * $dispatcher = new \Phalcon\Mvc\Dispatcher();</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * $dispatcher-&gt;setDI($di);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * $dispatcher-&gt;setControllerName(&quot;posts&quot;);</span></span><br><span class="line"><span class="comment"> * $dispatcher-&gt;setActionName(&quot;index&quot;);</span></span><br><span class="line"><span class="comment"> * $dispatcher-&gt;setParams([]);</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * $controller = $dispatcher-&gt;dispatch();</span></span><br><span class="line"><span class="comment"> * &lt;/code&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dispatcher</span> <span class="keyword">extends</span> \<span class="title">Phalcon</span>\<span class="title">Dispatcher</span> <span class="keyword">implements</span> \<span class="title">Phalcon</span>\<span class="title">Mvc</span>\<span class="title">DispatcherInterface</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$_handlerSuffix</span> = <span class="string">&quot;Controller&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$_defaultHandler</span> = <span class="string">&quot;index&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$_defaultAction</span> = <span class="string">&quot;index&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the default controller suffix</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $controllerSuffix</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setControllerSuffix</span>(<span class="params"><span class="variable">$controllerSuffix</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the default controller name</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $controllerName</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setDefaultController</span>(<span class="params"><span class="variable">$controllerName</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the controller name to be dispatched</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $controllerName</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setControllerName</span>(<span class="params"><span class="variable">$controllerName</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets last dispatched controller name</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getControllerName</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets previous dispatched namespace name</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPreviousNamespaceName</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets previous dispatched controller name</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPreviousControllerName</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Gets previous dispatched action name</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPreviousActionName</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Throws an internal exception</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string $message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> int $exceptionCode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_throwDispatchException</span>(<span class="params"><span class="variable">$message</span>, <span class="variable">$exceptionCode</span> = <span class="number">0</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Handles a user exception</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \Exception $exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_handleException</span>(<span class="params">\<span class="built_in">Exception</span> <span class="variable">$exception</span></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Possible controller class name that will be located to dispatch the request</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getControllerClass</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the latest dispatched controller</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Phalcon\Mvc\ControllerInterface</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLastController</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the active controller in the dispatcher</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \Phalcon\Mvc\ControllerInterface</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getActiveController</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºè¿™é‡Œæˆ‘åˆ›å»ºçš„æ˜¯ <code>Phalcon Micro Project</code>ï¼Œä¸»è¦ç”¨æ¥å†™æ¥å£ <code>API</code> ç”¨çš„ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹ä¸­å°±æ²¡æœ‰æåŠ <code>View</code>ã€‚å½“ç„¶ <code>View</code> æ¨¡å—å¹¶ä¸æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µå¯åŠ¨çš„ï¼Œå®ƒä¹Ÿæ˜¯å…ˆäºè°ƒåº¦åˆ†å‘å‰å¯åŠ¨çš„ã€‚å¦‚æœè°ƒåº¦åˆ†å‘é˜¶æ®µå‡ºç°ä»»ä½•é”™è¯¯ï¼Œéƒ½éœ€è¦ <code>View</code> å°†é—®é¢˜æ˜¾ç¤ºå‡ºæ¥çš„</p><p>è°ƒåº¦å™¨ä¹Ÿæ˜¯ä» <code>DI</code> å®¹å™¨ä¸­é€šè¿‡é”®å <code>dispatcher</code> è·å–çš„ï¼Œè·¯ç”±çš„åˆ†å‘éœ€è¦è°ƒåº¦å™¨åˆ†æ´¾ï¼Œå› æ­¤è°ƒåº¦å™¨éœ€è¦å–å¾—è·¯ç”±çš„è¯¦æƒ…ä¿¡æ¯ï¼Œå¦‚ï¼šå‘½åç©ºé—´\æ¨¡å—å\ç±»å\åŠ¨ä½œå\å‚æ•°</p><h3 id="æ¸²æŸ“"><a href="#æ¸²æŸ“" class="headerlink" title="æ¸²æŸ“"></a>æ¸²æŸ“</h3><h3 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h3><p>èµ°åˆ°è¿™é‡Œï¼Œéœ€è¦æ±‡æ€»ä¸€ä¸ªå”¯ä¸€çš„å“åº”ä¸€è‡´å¯¹å¤–ã€‚æ­¤æ—¶ä¼šè§¦å‘ <code>beforeSendResponse</code>ï¼Œå¹¶è°ƒç”¨ <code>Phalcon\Http\Response-&gt;sendHeaders()</code> å’Œ <code>Phalcon\Http\Response-&gt;sendCookies()</code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å»è®¾ç½®ï¼Œç„¶åå¯¹å¤–è¿”å›ä¸€ä¸ª <code>Phalcon\Http\Response</code> å“åº”</p><p>æœªå®Œå¾…ç»­â€¦â€¦</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article><nav class="pagination"><a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left" aria-label="ğŸ‘ˆ ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right" aria-label="ğŸ‘‰ ä¸‹ä¸€é¡µ"></i></a></nav></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">ğŸ“š æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ğŸŒˆ ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="ç¬”è€…å¶åƒ" src="https://inotes.oss-cn-beijing.aliyuncs.com/common/201812/avatar.jpg"><p class="site-author-name" itemprop="name">ç¬”è€…å¶åƒ</p><div class="site-description" itemprop="description">è¿›ä¸€å¯¸è‡ªæœ‰ä¸€å¯¸çš„æ¬¢å–œ ğŸ‰</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">101</span> <span class="site-state-item-name">ğŸ“‘ æ—¥å¿—</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">ğŸ—³ åˆ†ç±»</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">ğŸ”– æ ‡ç­¾</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/imajinyun" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;imajinyun" rel="noopener" target="_blank"><i class="fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:imajinyun@gmail.com" title="E-Mail â†’ mailto:imajinyun@gmail.com" rel="noopener" target="_blank"><i class="fa-envelope fa-fw"></i>E-Mail</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2018 â€“ <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Jinyun's Notes</span></div><div class="powered-by">ğŸ™ ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨</div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>CONFIG.page.isPost&&(wpac_init=window.wpac_init||[],wpac_init.push({widget:"Rating",id:9009,el:"wpac-rating",color:"fc6423"}),function(){if(!("WIDGETPACK_LOADED"in window)){WIDGETPACK_LOADED=!0;var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//embed.widgetpack.com/widget.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t.nextSibling)}}())</script><script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/algolia-search.js"></script></body></html>